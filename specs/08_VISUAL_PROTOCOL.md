
# 08. VISUAL PROTOCOL & DYNAMIC EXECUTION

> **Core Concept:** "Show, Don't Just Tell."

## 1. PURPOSE
To transform ZIA from a text-based interface into a multimodal workbench capable of rendering charts, dataframes, and interactive HTML applications generated by the Compute Swarm.

## 2. DATA STRUCTURE (JSON)

The communication between the Swarm (Colab) and the Client (React) follows this schema for visual artifacts.

### Request (App -> Drive)
Filename: `req_python_exec_<timestamp>.json`
```json
{
  "id": "task_123",
  "code": "import matplotlib.pyplot as plt\nplt.plot([1,2,3])",
  "return_image": true,
  "return_html": false
}
```

### Response (Drive -> App)
Filename: `res_python_exec_<timestamp>.json`
```json
{
  "id": "task_123",
  "status": "success",
  "stdout": "Generating plot...", 
  "stderr": "",
  "artifacts": {
    "image_base64": "iVBORw0KGgo...",  // Matplotlib Plot
    "html_content": "<table>...</table>", // Pandas DF or Report
    "file_path": "/content/drive/..."     // Saved file path
  }
}
```

## 3. RENDERING LOGIC (ArtifactCanvas)
The `ArtifactCanvas` component acts as a polymorphic viewer:
1.  **Code Mode:** Displays the raw Python code (Monaco/Highlight).
2.  **Preview Mode (Image):** Renders Base64 strings as `<img>`.
3.  **Preview Mode (HTML):** Renders HTML content inside a sandboxed `<iframe>`.

## 4. SECURITY & CONSTRAINTS
- **Sandboxing:** All HTML must be rendered in a sandboxed iframe to prevent XSS.
- **Resource Limits:** Image size should be optimized (DPI 100) to prevent JSON bloat > 10MB.
